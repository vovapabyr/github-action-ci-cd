apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
- deployment-blue.yaml
- deployment-green.yaml
- service-blue.yaml
- service-green.yaml
- ingress.yaml
images:
- name: hello-gitops
  newName: pabyrivskyiv/hello-gitops
  newTag: 174681a3b1e9b176ea5ac5aa508957d5b43e7239

patches:
- patch: '[{"op": "replace", "path": "/spec/rules/0/http/paths/0/backend/service/name",
    "value": "hello-gitops-blue"}]'
  target:
    group: networking.k8s.io
    kind: Ingress
    name: hello-gitops
    version: v1
- path: ingress-patch-blue.json
  target:
    kind: Ingress
    name: hello-gitops
- path: ingress-patch-green.json
  target:
    kind: Ingress
    name: hello-gitops
